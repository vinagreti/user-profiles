<ng-container *ngIf="currentUser$ | async as currentUser">
  <ng-container *ngIf="users$ | async as users">
    <div class="flex-row flex-space-between flex-align-center">
      <h1>
        Users
        <small
          ><small>({{ users.length }})</small></small
        >
      </h1>
      <div>
        <button (click)="onAddNewUserClicked()" color="primary">
          + New User
        </button>
      </div>
    </div>
    <div class="flex-column flex-gap-8px">
      <ng-container *ngFor="let user of users; trackBy: trackByUser">
        <div [ngClass]="{ me: user.id === currentUser.id }" class="flex-row">
          <div class="flex-grow">
            {{ user.name }}
          </div>
          <div class="flex-grow">
            {{ user.email }}
          </div>
          <div>
            <select
              *ngIf="currentUser.level === USER_LEVEL.ADMIN"
              name="user-{{ user.id }}-level-selector"
              attr.aria-label="user {{ user.id }} level selector"
              [value]="user.level"
              [disabled]="user.id === currentUser.id"
              (change)="onLevelChanged(user, $any($event.target).value)"
            >
              <option
                *ngFor="let userLevelOptionValue of USER_LEVELS"
                [value]="userLevelOptionValue"
                [selected]="user.level == userLevelOptionValue"
              >
                {{ userLevelOptionValue }}
              </option>
            </select>
          </div>
        </div>
      </ng-container>
    </div>
  </ng-container>
</ng-container>
